---
phase: 10-agent-decision-quality
plan: 03
type: execute
wave: 3
depends_on: ["10-02"]
files_modified:
  - src/routes/pages.tsx
autonomous: false

must_haves:
  truths:
    - "User can view decision quality dashboard at /decision-quality"
    - "User can see per-agent quality breakdown with all 5 dimensions"
    - "User can see composite score and grade for each agent"
  artifacts:
    - path: "src/routes/pages.tsx"
      provides: "/decision-quality route"
      contains: "decision-quality"
  key_links:
    - from: "src/routes/pages.tsx"
      to: "src/services/decision-quality-dashboard.ts"
      via: "function import"
      pattern: "generateDecisionQualityReport|getLatestQualitySnapshot"
---

<objective>
Create the /decision-quality dashboard route in pages.tsx showing unified quality metrics.

Purpose: Surface all the quality data that exists in the codebase but isn't visible to users. The 5 quality services track calibration, integrity, accountability, memory, and tool use - but there's no UI to see this data. This makes decision quality transparent and helps identify which agents need improvement.

Output: New /decision-quality route showing all agents with their quality scores, grades, strengths, weaknesses, and trend indicators.
</objective>

<execution_context>
@/Users/patruff/.claude/get-shit-done/workflows/execute-plan.md
@/Users/patruff/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/phases/10-agent-decision-quality/10-RESEARCH.md
@.planning/phases/10-agent-decision-quality/10-02-SUMMARY.md

# Existing UI patterns
@src/routes/pages.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add decision quality dashboard route</name>
  <files>src/routes/pages.tsx</files>
  <action>
Add `/decision-quality` route to pages.tsx following the existing pattern from `/economics`:

1. **Import the service:**
```typescript
import { generateDecisionQualityReport, type DecisionQualityReport } from "../services/decision-quality-dashboard.ts";
```

2. **Add route handler (place after /economics route):**
```typescript
pages.get("/decision-quality", async (c) => {
  // Get all active agents
  const agentList = await db.select().from(agents).where(eq(agents.status, "active"));

  // Generate quality reports for each agent
  const reports: DecisionQualityReport[] = [];
  for (const agent of agentList) {
    try {
      const report = await generateDecisionQualityReport(agent.id);
      reports.push(report);
    } catch (err) {
      console.warn(`Failed to generate quality report for ${agent.id}:`, err);
    }
  }

  // Sort by composite score descending
  reports.sort((a, b) => b.compositeScore - a.compositeScore);

  return c.render(/* JSX content */, { title: "Decision Quality | MoltApp" });
});
```

3. **JSX Layout (follow /economics pattern):**
- Header: "Decision Quality Dashboard" with link back to home
- Summary cards row:
  - Average Composite Score (across all agents)
  - Best Performing Dimension
  - Worst Performing Dimension
- Per-agent quality cards (one card per agent):
  - Agent name + overall grade badge (A+, A, B+, etc.)
  - Composite score with progress bar
  - 5 dimension scores in a grid:
    - Calibration (ECE inverted to 0-100 scale)
    - Integrity
    - Accountability
    - Memory
    - Tool Use
  - Strengths list (green text)
  - Weaknesses list (red text)
  - Link to agent profile

4. **Styling (use existing TailwindCSS patterns):**
- Grade badges: A/A+ = green, B = blue, C = yellow, D/F = red
- Score bars: gray-700 background, colored fill based on score
- Use existing card pattern: bg-gray-900 rounded-lg p-4
- Responsive grid: 1 col on mobile, 2 on md, 3 on lg

5. **Add link to homepage header:**
In the header section near "View Economics" button, add:
```jsx
<a href="/decision-quality" class="text-blue-400 hover:text-blue-300">
  Decision Quality â†’
</a>
```
  </action>
  <verify>
`npx tsc --noEmit` passes with no errors.
grep "decision-quality" src/routes/pages.tsx returns route handler.
Route is accessible (test with curl or browser).
  </verify>
  <done>Route exists at /decision-quality. Shows all agents with quality metrics. TypeScript compiles.</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Decision Quality Dashboard at /decision-quality showing unified quality metrics for all agents</what-built>
  <how-to-verify>
1. Start the dev server: `npm run dev`
2. Navigate to http://localhost:3000/decision-quality
3. Verify you see:
   - Summary cards with aggregate metrics
   - Per-agent quality cards with grades
   - 5 dimension scores displayed for each agent
   - Strengths/weaknesses lists
4. Navigate to homepage and verify "Decision Quality" link appears in header
5. Click through to agent profiles and back
  </how-to-verify>
  <resume-signal>Type "approved" or describe any issues with the layout/functionality</resume-signal>
</task>

</tasks>

<verification>
1. `npx tsc --noEmit` - zero TypeScript errors
2. /decision-quality route renders without errors
3. All 5 quality dimensions displayed per agent
4. Homepage has link to decision quality dashboard
5. UI is consistent with existing pages (economics, leaderboard)
</verification>

<success_criteria>
- /decision-quality route exists and renders
- Shows quality metrics for all active agents
- Displays all 5 dimensions: calibration, integrity, accountability, memory, tool use
- Grade badges display correctly (A+ through F)
- Homepage links to new dashboard
- User verification confirms layout looks good
- TypeScript compilation: 0 errors
</success_criteria>

<output>
After completion, create `.planning/phases/10-agent-decision-quality/10-03-SUMMARY.md`
</output>
